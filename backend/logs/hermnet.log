2026-02-12 11:42:45 [main] INFO  c.h.a.controller.AuthControllerTest - Starting AuthControllerTest using Java 21.0.6 with PID 11200 (started by alvar in C:\Users\alvar\Desktop\Hermnet\backend)
2026-02-12 11:42:45 [main] INFO  c.h.a.controller.AuthControllerTest - No active profile set, falling back to 1 default profile: "default"
2026-02-12 11:42:49 [main] WARN  o.s.b.a.s.s.UserDetailsServiceAutoConfiguration - 

Using generated security password: c943db17-0f35-4e65-8ded-0d1d19eb3b08

This generated password is for development use only. Your security configuration must be updated before running your application in production.

2026-02-12 11:42:50 [main] INFO  c.h.a.controller.AuthControllerTest - Started AuthControllerTest in 5.081 seconds (process running for 6.991)
2026-02-12 11:42:50 [main] WARN  o.s.w.s.m.s.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.hermnet.api.dto.UserResponse> com.hermnet.api.controller.AuthController.register(com.hermnet.api.dto.RegisterRequest): [Field error in object 'registerRequest' on field 'publicKey': rejected value []; codes [NotBlank.registerRequest.publicKey,NotBlank.publicKey,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [registerRequest.publicKey,publicKey]; arguments []; default message [publicKey]]; default message [La clave pública es obligatoria]] ]
2026-02-12 11:42:50 [main] WARN  o.s.w.s.m.s.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.hermnet.api.dto.UserResponse> com.hermnet.api.controller.AuthController.register(com.hermnet.api.dto.RegisterRequest): [Field error in object 'registerRequest' on field 'id': rejected value [INVALID-ID]; codes [Pattern.registerRequest.id,Pattern.id,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [registerRequest.id,id]; arguments []; default message [id],[Ljakarta.validation.constraints.Pattern$Flag;@19c1f6f4,^HNET-[A-Za-z0-9]{5,}$]; default message [El ID debe empezar por HNET- y tener caracteres alfanuméricos]] ]
2026-02-12 11:44:02 [main] INFO  c.h.a.controller.AuthControllerTest - Starting AuthControllerTest using Java 21.0.6 with PID 340 (started by alvar in C:\Users\alvar\Desktop\Hermnet\backend)
2026-02-12 11:44:02 [main] INFO  c.h.a.controller.AuthControllerTest - No active profile set, falling back to 1 default profile: "default"
2026-02-12 11:44:06 [main] WARN  o.s.b.a.s.s.UserDetailsServiceAutoConfiguration - 

Using generated security password: 2280809c-e463-4523-a179-a1a8041abfcd

This generated password is for development use only. Your security configuration must be updated before running your application in production.

2026-02-12 11:44:06 [main] INFO  c.h.a.controller.AuthControllerTest - Started AuthControllerTest in 4.516 seconds (process running for 6.16)
2026-02-12 11:44:06 [main] WARN  o.s.w.s.m.s.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.hermnet.api.dto.UserResponse> com.hermnet.api.controller.AuthController.register(com.hermnet.api.dto.RegisterRequest): [Field error in object 'registerRequest' on field 'publicKey': rejected value []; codes [NotBlank.registerRequest.publicKey,NotBlank.publicKey,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [registerRequest.publicKey,publicKey]; arguments []; default message [publicKey]]; default message [La clave pública es obligatoria]] ]
2026-02-12 11:44:06 [main] WARN  o.s.w.s.m.s.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.hermnet.api.dto.UserResponse> com.hermnet.api.controller.AuthController.register(com.hermnet.api.dto.RegisterRequest): [Field error in object 'registerRequest' on field 'id': rejected value [INVALID-ID]; codes [Pattern.registerRequest.id,Pattern.id,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [registerRequest.id,id]; arguments []; default message [id],[Ljakarta.validation.constraints.Pattern$Flag;@1f19d423,^HNET-[A-Za-z0-9]{5,}$]; default message [El ID debe empezar por HNET- y tener caracteres alfanuméricos]] ]
2026-02-12 11:45:17 [main] INFO  c.h.a.controller.AuthControllerTest - Starting AuthControllerTest using Java 21.0.6 with PID 3224 (started by alvar in C:\Users\alvar\Desktop\Hermnet\backend)
2026-02-12 11:45:17 [main] INFO  c.h.a.controller.AuthControllerTest - No active profile set, falling back to 1 default profile: "default"
2026-02-12 11:45:19 [main] WARN  o.s.b.a.s.s.UserDetailsServiceAutoConfiguration - 

Using generated security password: 2a4755a2-44ef-4b39-9b68-831dab1c0484

This generated password is for development use only. Your security configuration must be updated before running your application in production.

2026-02-12 11:45:19 [main] INFO  c.h.a.controller.AuthControllerTest - Started AuthControllerTest in 3.168 seconds (process running for 7.255)
2026-02-12 11:45:19 [main] WARN  o.s.w.s.m.s.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.hermnet.api.dto.UserResponse> com.hermnet.api.controller.AuthController.register(com.hermnet.api.dto.RegisterRequest): [Field error in object 'registerRequest' on field 'publicKey': rejected value []; codes [NotBlank.registerRequest.publicKey,NotBlank.publicKey,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [registerRequest.publicKey,publicKey]; arguments []; default message [publicKey]]; default message [La clave pública es obligatoria]] ]
2026-02-12 11:45:19 [main] WARN  o.s.w.s.m.s.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.hermnet.api.dto.UserResponse> com.hermnet.api.controller.AuthController.register(com.hermnet.api.dto.RegisterRequest): [Field error in object 'registerRequest' on field 'id': rejected value [INVALID-ID]; codes [Pattern.registerRequest.id,Pattern.id,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [registerRequest.id,id]; arguments []; default message [id],[Ljakarta.validation.constraints.Pattern$Flag;@7e63374b,^HNET-[A-Za-z0-9]{5,}$]; default message [El ID debe empezar por HNET- y tener caracteres alfanuméricos]] ]
2026-02-12 11:45:20 [main] INFO  c.h.api.HermnetApiApplicationTests - Starting HermnetApiApplicationTests using Java 21.0.6 with PID 3224 (started by alvar in C:\Users\alvar\Desktop\Hermnet\backend)
2026-02-12 11:45:20 [main] INFO  c.h.api.HermnetApiApplicationTests - No active profile set, falling back to 1 default profile: "default"
2026-02-12 11:45:21 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2026-02-12 11:45:21 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@5b4880b3
2026-02-12 11:45:21 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2026-02-12 11:45:22 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2026-02-12 11:45:23 [main] DEBUG org.hibernate.SQL - set client_min_messages = WARNING
2026-02-12 11:45:23 [main] DEBUG org.hibernate.SQL - alter table if exists auth_challenges drop constraint if exists FKl5m80koyne9ork274crpw6jv
2026-02-12 11:45:23 [main] DEBUG org.hibernate.SQL - drop table if exists auth_challenges cascade
2026-02-12 11:45:23 [main] DEBUG org.hibernate.SQL - drop table if exists mailbox cascade
2026-02-12 11:45:23 [main] DEBUG org.hibernate.SQL - drop table if exists rate_limit_buckets cascade
2026-02-12 11:45:23 [main] DEBUG org.hibernate.SQL - drop table if exists token_blacklist cascade
2026-02-12 11:45:23 [main] DEBUG org.hibernate.SQL - drop table if exists users cascade
2026-02-12 11:45:23 [main] DEBUG org.hibernate.SQL - create table auth_challenges (challenge_id bigint generated by default as identity, expires_at timestamp(6) not null, nonce varchar(64) not null, user_hash varchar(64) not null, primary key (challenge_id))
2026-02-12 11:45:23 [main] DEBUG org.hibernate.SQL - create table mailbox (created_at timestamp(6) not null, message_id bigint generated by default as identity, recipient_hash varchar(64) not null, stego_packet oid not null, primary key (message_id))
2026-02-12 11:45:23 [main] DEBUG org.hibernate.SQL - create table rate_limit_buckets (request_count integer not null, reset_time timestamp(6) not null, ip_hash varchar(64) not null, primary key (ip_hash))
2026-02-12 11:45:23 [main] DEBUG org.hibernate.SQL - create table token_blacklist (expires_at timestamp(6) not null, revoked_reason varchar(20), jti varchar(36) not null, primary key (jti))
2026-02-12 11:45:23 [main] DEBUG org.hibernate.SQL - create table users (created_at timestamp(6) not null, id_hash varchar(64) not null, public_key TEXT not null unique, push_token TEXT, primary key (id_hash))
2026-02-12 11:45:23 [main] DEBUG org.hibernate.SQL - create index idx_mailbox_recipient on mailbox (recipient_hash)
2026-02-12 11:45:23 [main] DEBUG org.hibernate.SQL - alter table if exists auth_challenges add constraint FKl5m80koyne9ork274crpw6jv foreign key (user_hash) references users
2026-02-12 11:45:24 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2026-02-12 11:45:24 [main] WARN  o.s.b.a.s.s.UserDetailsServiceAutoConfiguration - 

Using generated security password: 72a870f7-e847-4452-800a-940adc75dc21

This generated password is for development use only. Your security configuration must be updated before running your application in production.

2026-02-12 11:45:24 [main] INFO  c.h.api.HermnetApiApplicationTests - Started HermnetApiApplicationTests in 4.637 seconds (process running for 12.472)
2026-02-12 11:45:24 [main] INFO  c.h.a.r.AuthChallengeRepositoryTest - Starting AuthChallengeRepositoryTest using Java 21.0.6 with PID 3224 (started by alvar in C:\Users\alvar\Desktop\Hermnet\backend)
2026-02-12 11:45:24 [main] INFO  c.h.a.r.AuthChallengeRepositoryTest - No active profile set, falling back to 1 default profile: "default"
2026-02-12 11:45:25 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-2 - Starting...
2026-02-12 11:45:25 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-2 - Added connection org.postgresql.jdbc.PgConnection@731660c1
2026-02-12 11:45:25 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-2 - Start completed.
2026-02-12 11:45:25 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2026-02-12 11:45:25 [main] DEBUG org.hibernate.SQL - set client_min_messages = WARNING
2026-02-12 11:45:25 [main] DEBUG org.hibernate.SQL - alter table if exists auth_challenges drop constraint if exists FKl5m80koyne9ork274crpw6jv
2026-02-12 11:45:25 [main] DEBUG org.hibernate.SQL - drop table if exists auth_challenges cascade
2026-02-12 11:45:25 [main] DEBUG org.hibernate.SQL - drop table if exists mailbox cascade
2026-02-12 11:45:25 [main] DEBUG org.hibernate.SQL - drop table if exists rate_limit_buckets cascade
2026-02-12 11:45:25 [main] DEBUG org.hibernate.SQL - drop table if exists token_blacklist cascade
2026-02-12 11:45:25 [main] DEBUG org.hibernate.SQL - drop table if exists users cascade
2026-02-12 11:45:25 [main] DEBUG org.hibernate.SQL - create table auth_challenges (challenge_id bigint generated by default as identity, expires_at timestamp(6) not null, nonce varchar(64) not null, user_hash varchar(64) not null, primary key (challenge_id))
2026-02-12 11:45:25 [main] DEBUG org.hibernate.SQL - create table mailbox (created_at timestamp(6) not null, message_id bigint generated by default as identity, recipient_hash varchar(64) not null, stego_packet oid not null, primary key (message_id))
2026-02-12 11:45:25 [main] DEBUG org.hibernate.SQL - create table rate_limit_buckets (request_count integer not null, reset_time timestamp(6) not null, ip_hash varchar(64) not null, primary key (ip_hash))
2026-02-12 11:45:25 [main] DEBUG org.hibernate.SQL - create table token_blacklist (expires_at timestamp(6) not null, revoked_reason varchar(20), jti varchar(36) not null, primary key (jti))
2026-02-12 11:45:25 [main] DEBUG org.hibernate.SQL - create table users (created_at timestamp(6) not null, id_hash varchar(64) not null, public_key TEXT not null unique, push_token TEXT, primary key (id_hash))
2026-02-12 11:45:25 [main] DEBUG org.hibernate.SQL - create index idx_mailbox_recipient on mailbox (recipient_hash)
2026-02-12 11:45:25 [main] DEBUG org.hibernate.SQL - alter table if exists auth_challenges add constraint FKl5m80koyne9ork274crpw6jv foreign key (user_hash) references users
2026-02-12 11:45:25 [main] INFO  c.h.a.r.AuthChallengeRepositoryTest - Started AuthChallengeRepositoryTest in 0.688 seconds (process running for 13.372)
2026-02-12 11:45:25 [main] DEBUG org.hibernate.SQL - select ac1_0.challenge_id,ac1_0.expires_at,ac1_0.nonce,ac1_0.user_hash from auth_challenges ac1_0
2026-02-12 11:45:25 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 11:45:25 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:45:25 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 11:45:25 [main] DEBUG org.hibernate.SQL - select null,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:45:25 [main] DEBUG org.hibernate.SQL - insert into auth_challenges (expires_at,nonce,user_hash) values (?,?,?)
2026-02-12 11:45:25 [main] DEBUG org.hibernate.SQL - insert into auth_challenges (expires_at,nonce,user_hash) values (?,?,?)
2026-02-12 11:45:25 [main] DEBUG org.hibernate.SQL - select ac1_0.challenge_id,ac1_0.expires_at,ac1_0.nonce,ac1_0.user_hash from auth_challenges ac1_0 where ac1_0.expires_at<?
2026-02-12 11:45:25 [main] DEBUG org.hibernate.SQL - delete from auth_challenges where challenge_id=?
2026-02-12 11:45:25 [main] DEBUG org.hibernate.SQL - select ac1_0.challenge_id,ac1_0.expires_at,ac1_0.nonce,ac1_0.user_hash from auth_challenges ac1_0
2026-02-12 11:45:25 [main] DEBUG org.hibernate.SQL - select ac1_0.challenge_id,ac1_0.expires_at,ac1_0.nonce,ac1_0.user_hash from auth_challenges ac1_0
2026-02-12 11:45:25 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 11:45:25 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:45:25 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 11:45:25 [main] DEBUG org.hibernate.SQL - select null,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:45:25 [main] DEBUG org.hibernate.SQL - insert into auth_challenges (expires_at,nonce,user_hash) values (?,?,?)
2026-02-12 11:45:25 [main] DEBUG org.hibernate.SQL - select ac1_0.challenge_id,ac1_0.expires_at,ac1_0.nonce,ac1_0.user_hash from auth_challenges ac1_0 where ac1_0.nonce=?
2026-02-12 11:45:25 [main] DEBUG org.hibernate.SQL - select ac1_0.challenge_id,ac1_0.expires_at,ac1_0.nonce,ac1_0.user_hash from auth_challenges ac1_0
2026-02-12 11:45:25 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 11:45:25 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:45:25 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 11:45:25 [main] DEBUG org.hibernate.SQL - select null,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:45:25 [main] DEBUG org.hibernate.SQL - insert into auth_challenges (expires_at,nonce,user_hash) values (?,?,?)
2026-02-12 11:45:25 [main] DEBUG org.hibernate.SQL - insert into auth_challenges (expires_at,nonce,user_hash) values (?,?,?)
2026-02-12 11:45:25 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:45:25 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 11:45:25 [main] DEBUG org.hibernate.SQL - select null,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:45:25 [main] DEBUG org.hibernate.SQL - insert into auth_challenges (expires_at,nonce,user_hash) values (?,?,?)
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - select count(*) from auth_challenges ac1_0
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - select ac1_0.challenge_id,ac1_0.expires_at,ac1_0.nonce,ac1_0.user_hash from auth_challenges ac1_0 where ac1_0.user_hash=?
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - delete from auth_challenges where challenge_id=?
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - delete from auth_challenges where challenge_id=?
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - select count(*) from auth_challenges ac1_0
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - select ac1_0.challenge_id,ac1_0.expires_at,ac1_0.nonce,ac1_0.user_hash from auth_challenges ac1_0 where ac1_0.nonce=?
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - select ac1_0.challenge_id,ac1_0.expires_at,ac1_0.nonce,ac1_0.user_hash from auth_challenges ac1_0
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - select ac1_0.challenge_id,ac1_0.expires_at,ac1_0.nonce,ac1_0.user_hash from auth_challenges ac1_0 where ac1_0.user_hash=?
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - select bt1_0.jti,bt1_0.expires_at,bt1_0.revoked_reason from token_blacklist bt1_0
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - select bt1_0.jti,bt1_0.expires_at,bt1_0.revoked_reason from token_blacklist bt1_0 where bt1_0.jti=?
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - select bt1_0.jti,bt1_0.expires_at,bt1_0.revoked_reason from token_blacklist bt1_0
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - select bt1_0.jti,bt1_0.expires_at,bt1_0.revoked_reason from token_blacklist bt1_0 where bt1_0.jti=?
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - insert into token_blacklist (expires_at,revoked_reason,jti) values (?,?,?)
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - select count(*) from token_blacklist bt1_0 where bt1_0.jti=?
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - select count(*) from token_blacklist bt1_0 where bt1_0.jti=?
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - select bt1_0.jti,bt1_0.expires_at,bt1_0.revoked_reason from token_blacklist bt1_0
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - select bt1_0.jti,bt1_0.expires_at,bt1_0.revoked_reason from token_blacklist bt1_0 where bt1_0.jti=?
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - insert into token_blacklist (expires_at,revoked_reason,jti) values (?,?,?)
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - select count(*) from token_blacklist bt1_0 where bt1_0.jti=?
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - delete from token_blacklist where jti=?
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - select count(*) from token_blacklist bt1_0 where bt1_0.jti=?
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - select m1_0.message_id,m1_0.created_at,m1_0.recipient_hash,m1_0.stego_packet from mailbox m1_0
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - insert into mailbox (created_at,recipient_hash,stego_packet) values (?,?,?)
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - select m1_0.message_id,m1_0.created_at,m1_0.recipient_hash,m1_0.stego_packet from mailbox m1_0
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - select m1_0.message_id,m1_0.created_at,m1_0.recipient_hash,m1_0.stego_packet from mailbox m1_0
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - insert into mailbox (created_at,recipient_hash,stego_packet) values (?,?,?)
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - select m1_0.message_id,m1_0.created_at,m1_0.recipient_hash,m1_0.stego_packet from mailbox m1_0 where m1_0.created_at<?
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - delete from mailbox where message_id=?
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - select m1_0.message_id,m1_0.created_at,m1_0.recipient_hash,m1_0.stego_packet from mailbox m1_0
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - select m1_0.message_id,m1_0.created_at,m1_0.recipient_hash,m1_0.stego_packet from mailbox m1_0
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - insert into mailbox (created_at,recipient_hash,stego_packet) values (?,?,?)
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - insert into mailbox (created_at,recipient_hash,stego_packet) values (?,?,?)
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - insert into mailbox (created_at,recipient_hash,stego_packet) values (?,?,?)
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - select m1_0.message_id,m1_0.created_at,m1_0.recipient_hash,m1_0.stego_packet from mailbox m1_0 where m1_0.recipient_hash=? order by m1_0.created_at desc
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - select rlb1_0.ip_hash,rlb1_0.request_count,rlb1_0.reset_time from rate_limit_buckets rlb1_0
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - select rlb1_0.ip_hash,rlb1_0.request_count,rlb1_0.reset_time from rate_limit_buckets rlb1_0 where rlb1_0.ip_hash=?
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - select rlb1_0.ip_hash,rlb1_0.request_count,rlb1_0.reset_time from rate_limit_buckets rlb1_0
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - select rlb1_0.ip_hash,rlb1_0.request_count,rlb1_0.reset_time from rate_limit_buckets rlb1_0 where rlb1_0.ip_hash=?
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - select rlb1_0.ip_hash,rlb1_0.request_count,rlb1_0.reset_time from rate_limit_buckets rlb1_0
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - select rlb1_0.ip_hash,rlb1_0.request_count,rlb1_0.reset_time from rate_limit_buckets rlb1_0 where rlb1_0.ip_hash=?
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.public_key=?
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - select count(*) from users u1_0
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 11:45:26 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.public_key=?
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - select count(*) from users u1_0 where u1_0.id_hash=?
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - select count(*) from users u1_0 where u1_0.id_hash=?
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - delete from users where id_hash=?
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - select count(*) from users u1_0 where u1_0.id_hash=?
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - select count(*) from users u1_0
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 11:45:27 [main] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 23505
2026-02-12 11:45:27 [main] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: duplicate key value violates unique constraint "users_public_key_key"
  Detail: Key (public_key)=(duplicate-key) already exists.
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - delete from users where id_hash=?
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - select count(*) from users u1_0 where u1_0.id_hash=?
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - delete from users where id_hash=?
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - delete from users where id_hash=?
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - select count(*) from users u1_0
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - select count(*) from users u1_0
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - select count(*) from users u1_0
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - update users set public_key=?,push_token=? where id_hash=?
2026-02-12 11:45:27 [main] DEBUG org.hibernate.SQL - select count(*) from users u1_0
2026-02-12 11:45:27 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2026-02-12 11:45:27 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2026-02-12 11:45:27 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-2 - Shutdown initiated...
2026-02-12 11:45:27 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-2 - Shutdown completed.
2026-02-12 11:47:46 [main] INFO  c.h.a.controller.AuthControllerTest - Starting AuthControllerTest using Java 21.0.6 with PID 1600 (started by alvar in C:\Users\alvar\Desktop\Hermnet\backend)
2026-02-12 11:47:46 [main] INFO  c.h.a.controller.AuthControllerTest - No active profile set, falling back to 1 default profile: "default"
2026-02-12 11:47:48 [main] WARN  o.s.b.a.s.s.UserDetailsServiceAutoConfiguration - 

Using generated security password: b30048b3-687b-4048-9cdd-74c42a4b3496

This generated password is for development use only. Your security configuration must be updated before running your application in production.

2026-02-12 11:47:48 [main] INFO  c.h.a.controller.AuthControllerTest - Started AuthControllerTest in 3.067 seconds (process running for 6.721)
2026-02-12 11:47:49 [main] WARN  o.s.w.s.m.s.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.hermnet.api.dto.UserResponse> com.hermnet.api.controller.AuthController.register(com.hermnet.api.dto.RegisterRequest): [Field error in object 'registerRequest' on field 'publicKey': rejected value []; codes [NotBlank.registerRequest.publicKey,NotBlank.publicKey,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [registerRequest.publicKey,publicKey]; arguments []; default message [publicKey]]; default message [La clave pública es obligatoria]] ]
2026-02-12 11:47:49 [main] WARN  o.s.w.s.m.s.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.hermnet.api.dto.UserResponse> com.hermnet.api.controller.AuthController.register(com.hermnet.api.dto.RegisterRequest): [Field error in object 'registerRequest' on field 'id': rejected value [INVALID-ID]; codes [Pattern.registerRequest.id,Pattern.id,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [registerRequest.id,id]; arguments []; default message [id],[Ljakarta.validation.constraints.Pattern$Flag;@45753c22,^HNET-[A-Za-z0-9]{5,}$]; default message [El ID debe empezar por HNET- y tener caracteres alfanuméricos]] ]
2026-02-12 11:47:49 [main] INFO  c.h.api.HermnetApiApplicationTests - Starting HermnetApiApplicationTests using Java 21.0.6 with PID 1600 (started by alvar in C:\Users\alvar\Desktop\Hermnet\backend)
2026-02-12 11:47:49 [main] INFO  c.h.api.HermnetApiApplicationTests - No active profile set, falling back to 1 default profile: "default"
2026-02-12 11:47:50 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2026-02-12 11:47:50 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@1659d7d
2026-02-12 11:47:50 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2026-02-12 11:47:51 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2026-02-12 11:47:52 [main] DEBUG org.hibernate.SQL - set client_min_messages = WARNING
2026-02-12 11:47:52 [main] DEBUG org.hibernate.SQL - alter table if exists auth_challenges drop constraint if exists FKl5m80koyne9ork274crpw6jv
2026-02-12 11:47:52 [main] DEBUG org.hibernate.SQL - drop table if exists auth_challenges cascade
2026-02-12 11:47:52 [main] DEBUG org.hibernate.SQL - drop table if exists mailbox cascade
2026-02-12 11:47:52 [main] DEBUG org.hibernate.SQL - drop table if exists rate_limit_buckets cascade
2026-02-12 11:47:52 [main] DEBUG org.hibernate.SQL - drop table if exists token_blacklist cascade
2026-02-12 11:47:52 [main] DEBUG org.hibernate.SQL - drop table if exists users cascade
2026-02-12 11:47:52 [main] DEBUG org.hibernate.SQL - create table auth_challenges (challenge_id bigint generated by default as identity, expires_at timestamp(6) not null, nonce varchar(64) not null, user_hash varchar(64) not null, primary key (challenge_id))
2026-02-12 11:47:52 [main] DEBUG org.hibernate.SQL - create table mailbox (created_at timestamp(6) not null, message_id bigint generated by default as identity, recipient_hash varchar(64) not null, stego_packet oid not null, primary key (message_id))
2026-02-12 11:47:52 [main] DEBUG org.hibernate.SQL - create table rate_limit_buckets (request_count integer not null, reset_time timestamp(6) not null, ip_hash varchar(64) not null, primary key (ip_hash))
2026-02-12 11:47:52 [main] DEBUG org.hibernate.SQL - create table token_blacklist (expires_at timestamp(6) not null, revoked_reason varchar(20), jti varchar(36) not null, primary key (jti))
2026-02-12 11:47:52 [main] DEBUG org.hibernate.SQL - create table users (created_at timestamp(6) not null, id_hash varchar(64) not null, public_key TEXT not null unique, push_token TEXT, primary key (id_hash))
2026-02-12 11:47:52 [main] DEBUG org.hibernate.SQL - create index idx_mailbox_recipient on mailbox (recipient_hash)
2026-02-12 11:47:52 [main] DEBUG org.hibernate.SQL - alter table if exists auth_challenges add constraint FKl5m80koyne9ork274crpw6jv foreign key (user_hash) references users
2026-02-12 11:47:53 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2026-02-12 11:47:53 [main] WARN  o.s.b.a.s.s.UserDetailsServiceAutoConfiguration - 

Using generated security password: 076d00ed-6297-47df-af8c-fe3386a575f5

This generated password is for development use only. Your security configuration must be updated before running your application in production.

2026-02-12 11:47:53 [main] INFO  c.h.api.HermnetApiApplicationTests - Started HermnetApiApplicationTests in 4.308 seconds (process running for 11.575)
2026-02-12 11:47:53 [main] INFO  c.h.a.r.AuthChallengeRepositoryTest - Starting AuthChallengeRepositoryTest using Java 21.0.6 with PID 1600 (started by alvar in C:\Users\alvar\Desktop\Hermnet\backend)
2026-02-12 11:47:53 [main] INFO  c.h.a.r.AuthChallengeRepositoryTest - No active profile set, falling back to 1 default profile: "default"
2026-02-12 11:47:54 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-2 - Starting...
2026-02-12 11:47:54 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-2 - Added connection org.postgresql.jdbc.PgConnection@3e42cff9
2026-02-12 11:47:54 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-2 - Start completed.
2026-02-12 11:47:54 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2026-02-12 11:47:54 [main] DEBUG org.hibernate.SQL - set client_min_messages = WARNING
2026-02-12 11:47:54 [main] DEBUG org.hibernate.SQL - alter table if exists auth_challenges drop constraint if exists FKl5m80koyne9ork274crpw6jv
2026-02-12 11:47:54 [main] DEBUG org.hibernate.SQL - drop table if exists auth_challenges cascade
2026-02-12 11:47:54 [main] DEBUG org.hibernate.SQL - drop table if exists mailbox cascade
2026-02-12 11:47:54 [main] DEBUG org.hibernate.SQL - drop table if exists rate_limit_buckets cascade
2026-02-12 11:47:54 [main] DEBUG org.hibernate.SQL - drop table if exists token_blacklist cascade
2026-02-12 11:47:54 [main] DEBUG org.hibernate.SQL - drop table if exists users cascade
2026-02-12 11:47:54 [main] DEBUG org.hibernate.SQL - create table auth_challenges (challenge_id bigint generated by default as identity, expires_at timestamp(6) not null, nonce varchar(64) not null, user_hash varchar(64) not null, primary key (challenge_id))
2026-02-12 11:47:54 [main] DEBUG org.hibernate.SQL - create table mailbox (created_at timestamp(6) not null, message_id bigint generated by default as identity, recipient_hash varchar(64) not null, stego_packet oid not null, primary key (message_id))
2026-02-12 11:47:54 [main] DEBUG org.hibernate.SQL - create table rate_limit_buckets (request_count integer not null, reset_time timestamp(6) not null, ip_hash varchar(64) not null, primary key (ip_hash))
2026-02-12 11:47:54 [main] DEBUG org.hibernate.SQL - create table token_blacklist (expires_at timestamp(6) not null, revoked_reason varchar(20), jti varchar(36) not null, primary key (jti))
2026-02-12 11:47:54 [main] DEBUG org.hibernate.SQL - create table users (created_at timestamp(6) not null, id_hash varchar(64) not null, public_key TEXT not null unique, push_token TEXT, primary key (id_hash))
2026-02-12 11:47:54 [main] DEBUG org.hibernate.SQL - create index idx_mailbox_recipient on mailbox (recipient_hash)
2026-02-12 11:47:54 [main] DEBUG org.hibernate.SQL - alter table if exists auth_challenges add constraint FKl5m80koyne9ork274crpw6jv foreign key (user_hash) references users
2026-02-12 11:47:54 [main] INFO  c.h.a.r.AuthChallengeRepositoryTest - Started AuthChallengeRepositoryTest in 0.722 seconds (process running for 12.509)
2026-02-12 11:47:54 [main] DEBUG org.hibernate.SQL - select ac1_0.challenge_id,ac1_0.expires_at,ac1_0.nonce,ac1_0.user_hash from auth_challenges ac1_0
2026-02-12 11:47:54 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 11:47:54 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:47:54 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 11:47:54 [main] DEBUG org.hibernate.SQL - select null,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:47:54 [main] DEBUG org.hibernate.SQL - insert into auth_challenges (expires_at,nonce,user_hash) values (?,?,?)
2026-02-12 11:47:54 [main] DEBUG org.hibernate.SQL - insert into auth_challenges (expires_at,nonce,user_hash) values (?,?,?)
2026-02-12 11:47:54 [main] DEBUG org.hibernate.SQL - select ac1_0.challenge_id,ac1_0.expires_at,ac1_0.nonce,ac1_0.user_hash from auth_challenges ac1_0 where ac1_0.expires_at<?
2026-02-12 11:47:54 [main] DEBUG org.hibernate.SQL - delete from auth_challenges where challenge_id=?
2026-02-12 11:47:54 [main] DEBUG org.hibernate.SQL - select ac1_0.challenge_id,ac1_0.expires_at,ac1_0.nonce,ac1_0.user_hash from auth_challenges ac1_0
2026-02-12 11:47:54 [main] DEBUG org.hibernate.SQL - select ac1_0.challenge_id,ac1_0.expires_at,ac1_0.nonce,ac1_0.user_hash from auth_challenges ac1_0
2026-02-12 11:47:54 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 11:47:54 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:47:54 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 11:47:54 [main] DEBUG org.hibernate.SQL - select null,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:47:54 [main] DEBUG org.hibernate.SQL - insert into auth_challenges (expires_at,nonce,user_hash) values (?,?,?)
2026-02-12 11:47:54 [main] DEBUG org.hibernate.SQL - select ac1_0.challenge_id,ac1_0.expires_at,ac1_0.nonce,ac1_0.user_hash from auth_challenges ac1_0 where ac1_0.nonce=?
2026-02-12 11:47:54 [main] DEBUG org.hibernate.SQL - select ac1_0.challenge_id,ac1_0.expires_at,ac1_0.nonce,ac1_0.user_hash from auth_challenges ac1_0
2026-02-12 11:47:54 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 11:47:54 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:47:54 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 11:47:54 [main] DEBUG org.hibernate.SQL - select null,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:47:54 [main] DEBUG org.hibernate.SQL - insert into auth_challenges (expires_at,nonce,user_hash) values (?,?,?)
2026-02-12 11:47:54 [main] DEBUG org.hibernate.SQL - insert into auth_challenges (expires_at,nonce,user_hash) values (?,?,?)
2026-02-12 11:47:54 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:47:54 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 11:47:54 [main] DEBUG org.hibernate.SQL - select null,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:47:54 [main] DEBUG org.hibernate.SQL - insert into auth_challenges (expires_at,nonce,user_hash) values (?,?,?)
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select count(*) from auth_challenges ac1_0
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select ac1_0.challenge_id,ac1_0.expires_at,ac1_0.nonce,ac1_0.user_hash from auth_challenges ac1_0 where ac1_0.user_hash=?
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - delete from auth_challenges where challenge_id=?
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - delete from auth_challenges where challenge_id=?
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select count(*) from auth_challenges ac1_0
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select ac1_0.challenge_id,ac1_0.expires_at,ac1_0.nonce,ac1_0.user_hash from auth_challenges ac1_0 where ac1_0.nonce=?
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select ac1_0.challenge_id,ac1_0.expires_at,ac1_0.nonce,ac1_0.user_hash from auth_challenges ac1_0
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select ac1_0.challenge_id,ac1_0.expires_at,ac1_0.nonce,ac1_0.user_hash from auth_challenges ac1_0 where ac1_0.user_hash=?
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select bt1_0.jti,bt1_0.expires_at,bt1_0.revoked_reason from token_blacklist bt1_0
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select bt1_0.jti,bt1_0.expires_at,bt1_0.revoked_reason from token_blacklist bt1_0 where bt1_0.jti=?
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select bt1_0.jti,bt1_0.expires_at,bt1_0.revoked_reason from token_blacklist bt1_0
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select bt1_0.jti,bt1_0.expires_at,bt1_0.revoked_reason from token_blacklist bt1_0 where bt1_0.jti=?
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - insert into token_blacklist (expires_at,revoked_reason,jti) values (?,?,?)
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select count(*) from token_blacklist bt1_0 where bt1_0.jti=?
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select count(*) from token_blacklist bt1_0 where bt1_0.jti=?
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select bt1_0.jti,bt1_0.expires_at,bt1_0.revoked_reason from token_blacklist bt1_0
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select bt1_0.jti,bt1_0.expires_at,bt1_0.revoked_reason from token_blacklist bt1_0 where bt1_0.jti=?
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - insert into token_blacklist (expires_at,revoked_reason,jti) values (?,?,?)
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select count(*) from token_blacklist bt1_0 where bt1_0.jti=?
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - delete from token_blacklist where jti=?
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select count(*) from token_blacklist bt1_0 where bt1_0.jti=?
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select m1_0.message_id,m1_0.created_at,m1_0.recipient_hash,m1_0.stego_packet from mailbox m1_0
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - insert into mailbox (created_at,recipient_hash,stego_packet) values (?,?,?)
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select m1_0.message_id,m1_0.created_at,m1_0.recipient_hash,m1_0.stego_packet from mailbox m1_0
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select m1_0.message_id,m1_0.created_at,m1_0.recipient_hash,m1_0.stego_packet from mailbox m1_0
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - insert into mailbox (created_at,recipient_hash,stego_packet) values (?,?,?)
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select m1_0.message_id,m1_0.created_at,m1_0.recipient_hash,m1_0.stego_packet from mailbox m1_0 where m1_0.created_at<?
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - delete from mailbox where message_id=?
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select m1_0.message_id,m1_0.created_at,m1_0.recipient_hash,m1_0.stego_packet from mailbox m1_0
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select m1_0.message_id,m1_0.created_at,m1_0.recipient_hash,m1_0.stego_packet from mailbox m1_0
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - insert into mailbox (created_at,recipient_hash,stego_packet) values (?,?,?)
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - insert into mailbox (created_at,recipient_hash,stego_packet) values (?,?,?)
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - insert into mailbox (created_at,recipient_hash,stego_packet) values (?,?,?)
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select m1_0.message_id,m1_0.created_at,m1_0.recipient_hash,m1_0.stego_packet from mailbox m1_0 where m1_0.recipient_hash=? order by m1_0.created_at desc
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select rlb1_0.ip_hash,rlb1_0.request_count,rlb1_0.reset_time from rate_limit_buckets rlb1_0
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select rlb1_0.ip_hash,rlb1_0.request_count,rlb1_0.reset_time from rate_limit_buckets rlb1_0 where rlb1_0.ip_hash=?
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select rlb1_0.ip_hash,rlb1_0.request_count,rlb1_0.reset_time from rate_limit_buckets rlb1_0
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select rlb1_0.ip_hash,rlb1_0.request_count,rlb1_0.reset_time from rate_limit_buckets rlb1_0 where rlb1_0.ip_hash=?
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select rlb1_0.ip_hash,rlb1_0.request_count,rlb1_0.reset_time from rate_limit_buckets rlb1_0
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select rlb1_0.ip_hash,rlb1_0.request_count,rlb1_0.reset_time from rate_limit_buckets rlb1_0 where rlb1_0.ip_hash=?
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.public_key=?
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select count(*) from users u1_0
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.public_key=?
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select count(*) from users u1_0 where u1_0.id_hash=?
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select count(*) from users u1_0 where u1_0.id_hash=?
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - delete from users where id_hash=?
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select count(*) from users u1_0 where u1_0.id_hash=?
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select count(*) from users u1_0
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:47:55 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:47:56 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 11:47:56 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 11:47:56 [main] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 23505
2026-02-12 11:47:56 [main] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: duplicate key value violates unique constraint "users_public_key_key"
  Detail: Key (public_key)=(duplicate-key) already exists.
2026-02-12 11:47:56 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 11:47:56 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:47:56 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 11:47:56 [main] DEBUG org.hibernate.SQL - delete from users where id_hash=?
2026-02-12 11:47:56 [main] DEBUG org.hibernate.SQL - select count(*) from users u1_0 where u1_0.id_hash=?
2026-02-12 11:47:56 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 11:47:56 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:47:56 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:47:56 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 11:47:56 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 11:47:56 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 11:47:56 [main] DEBUG org.hibernate.SQL - delete from users where id_hash=?
2026-02-12 11:47:56 [main] DEBUG org.hibernate.SQL - delete from users where id_hash=?
2026-02-12 11:47:56 [main] DEBUG org.hibernate.SQL - select count(*) from users u1_0
2026-02-12 11:47:56 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 11:47:56 [main] DEBUG org.hibernate.SQL - select count(*) from users u1_0
2026-02-12 11:47:56 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 11:47:56 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:47:56 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 11:47:56 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:47:56 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:47:56 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 11:47:56 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 11:47:56 [main] DEBUG org.hibernate.SQL - select count(*) from users u1_0
2026-02-12 11:47:56 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 11:47:56 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 11:47:56 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 11:47:56 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 11:47:56 [main] DEBUG org.hibernate.SQL - update users set public_key=?,push_token=? where id_hash=?
2026-02-12 11:47:56 [main] DEBUG org.hibernate.SQL - select count(*) from users u1_0
2026-02-12 11:47:56 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2026-02-12 11:47:56 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2026-02-12 11:47:56 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-2 - Shutdown initiated...
2026-02-12 11:47:56 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-2 - Shutdown completed.
2026-02-12 11:57:07 [main] INFO  c.h.a.c.MessageControllerTest - Starting MessageControllerTest using Java 21.0.6 with PID 6852 (started by alvar in C:\Users\alvar\Desktop\Hermnet\backend)
2026-02-12 11:57:07 [main] INFO  c.h.a.c.MessageControllerTest - No active profile set, falling back to 1 default profile: "default"
2026-02-12 11:57:11 [main] WARN  o.s.b.a.s.s.UserDetailsServiceAutoConfiguration - 

Using generated security password: e0d648e4-c9f3-4ffd-92b0-6945950e32c0

This generated password is for development use only. Your security configuration must be updated before running your application in production.

2026-02-12 11:57:11 [main] INFO  c.h.a.c.MessageControllerTest - Started MessageControllerTest in 4.542 seconds (process running for 6.054)
2026-02-12 12:00:42 [main] INFO  c.h.a.c.MessageControllerTest - Starting MessageControllerTest using Java 21.0.6 with PID 5032 (started by alvar in C:\Users\alvar\Desktop\Hermnet\backend)
2026-02-12 12:00:42 [main] INFO  c.h.a.c.MessageControllerTest - No active profile set, falling back to 1 default profile: "default"
2026-02-12 12:00:46 [main] WARN  o.s.b.a.s.s.UserDetailsServiceAutoConfiguration - 

Using generated security password: 8d9a9f43-2807-4828-92f0-f1e9b2d46851

This generated password is for development use only. Your security configuration must be updated before running your application in production.

2026-02-12 12:00:46 [main] INFO  c.h.a.c.MessageControllerTest - Started MessageControllerTest in 4.57 seconds (process running for 6.099)
2026-02-12 12:00:46 [main] WARN  o.s.w.s.m.s.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<java.lang.Void> com.hermnet.api.controller.MessageController.sendMessage(com.hermnet.api.dto.SendMessageRequest): [Field error in object 'sendMessageRequest' on field 'stegoImage': rejected value [null]; codes [NotNull.sendMessageRequest.stegoImage,NotNull.stegoImage,NotNull.[B,NotNull]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendMessageRequest.stegoImage,stegoImage]; arguments []; default message [stegoImage]]; default message [Stego image is required]] ]
2026-02-12 12:00:46 [main] WARN  o.s.w.s.m.s.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<java.lang.Void> com.hermnet.api.controller.MessageController.sendMessage(com.hermnet.api.dto.SendMessageRequest): [Field error in object 'sendMessageRequest' on field 'recipientId': rejected value []; codes [NotBlank.sendMessageRequest.recipientId,NotBlank.recipientId,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendMessageRequest.recipientId,recipientId]; arguments []; default message [recipientId]]; default message [Recipient ID is required]] ]
2026-02-12 12:00:46 [main] WARN  o.s.w.s.m.s.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<java.lang.Void> com.hermnet.api.controller.MessageController.sendMessage(com.hermnet.api.dto.SendMessageRequest): [Field error in object 'sendMessageRequest' on field 'stegoImage': rejected value [{}]; codes [Size.sendMessageRequest.stegoImage,Size.stegoImage,Size.[B,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendMessageRequest.stegoImage,stegoImage]; arguments []; default message [stegoImage],2147483647,1]; default message [Stego image cannot be empty]] ]
2026-02-12 12:02:03 [main] INFO  c.h.a.controller.AuthControllerTest - Starting AuthControllerTest using Java 21.0.6 with PID 12528 (started by alvar in C:\Users\alvar\Desktop\Hermnet\backend)
2026-02-12 12:02:03 [main] INFO  c.h.a.controller.AuthControllerTest - No active profile set, falling back to 1 default profile: "default"
2026-02-12 12:02:07 [main] WARN  o.s.b.a.s.s.UserDetailsServiceAutoConfiguration - 

Using generated security password: d6d0511f-c18a-45ec-99c0-cccf9624c4b6

This generated password is for development use only. Your security configuration must be updated before running your application in production.

2026-02-12 12:02:07 [main] INFO  c.h.a.controller.AuthControllerTest - Started AuthControllerTest in 5.026 seconds (process running for 6.911)
2026-02-12 12:02:08 [main] WARN  o.s.w.s.m.s.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.hermnet.api.dto.UserResponse> com.hermnet.api.controller.AuthController.register(com.hermnet.api.dto.RegisterRequest): [Field error in object 'registerRequest' on field 'publicKey': rejected value []; codes [NotBlank.registerRequest.publicKey,NotBlank.publicKey,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [registerRequest.publicKey,publicKey]; arguments []; default message [publicKey]]; default message [La clave pública es obligatoria]] ]
2026-02-12 12:02:08 [main] WARN  o.s.w.s.m.s.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.hermnet.api.dto.UserResponse> com.hermnet.api.controller.AuthController.register(com.hermnet.api.dto.RegisterRequest): [Field error in object 'registerRequest' on field 'id': rejected value [HNET-1234]; codes [Pattern.registerRequest.id,Pattern.id,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [registerRequest.id,id]; arguments []; default message [id],[Ljakarta.validation.constraints.Pattern$Flag;@3bda1f0,^HNET-[A-Za-z0-9]{5,}$]; default message [El ID debe empezar por HNET- y tener caracteres alfanuméricos]] ]
2026-02-12 12:02:08 [main] WARN  o.s.w.s.m.s.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.hermnet.api.dto.UserResponse> com.hermnet.api.controller.AuthController.register(com.hermnet.api.dto.RegisterRequest): [Field error in object 'registerRequest' on field 'id': rejected value [INVALID-ID]; codes [Pattern.registerRequest.id,Pattern.id,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [registerRequest.id,id]; arguments []; default message [id],[Ljakarta.validation.constraints.Pattern$Flag;@3bda1f0,^HNET-[A-Za-z0-9]{5,}$]; default message [El ID debe empezar por HNET- y tener caracteres alfanuméricos]] ]
2026-02-12 12:02:08 [main] INFO  c.h.a.c.MessageControllerTest - Starting MessageControllerTest using Java 21.0.6 with PID 12528 (started by alvar in C:\Users\alvar\Desktop\Hermnet\backend)
2026-02-12 12:02:08 [main] INFO  c.h.a.c.MessageControllerTest - No active profile set, falling back to 1 default profile: "default"
2026-02-12 12:02:09 [main] WARN  o.s.b.a.s.s.UserDetailsServiceAutoConfiguration - 

Using generated security password: f943a72b-53d7-41f9-b5c6-c4af719a10b9

This generated password is for development use only. Your security configuration must be updated before running your application in production.

2026-02-12 12:02:09 [main] INFO  c.h.a.c.MessageControllerTest - Started MessageControllerTest in 1.144 seconds (process running for 9.025)
2026-02-12 12:02:09 [main] WARN  o.s.w.s.m.s.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<java.lang.Void> com.hermnet.api.controller.MessageController.sendMessage(com.hermnet.api.dto.SendMessageRequest): [Field error in object 'sendMessageRequest' on field 'stegoImage': rejected value [null]; codes [NotNull.sendMessageRequest.stegoImage,NotNull.stegoImage,NotNull.[B,NotNull]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendMessageRequest.stegoImage,stegoImage]; arguments []; default message [stegoImage]]; default message [Stego image is required]] ]
2026-02-12 12:02:09 [main] WARN  o.s.w.s.m.s.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<java.lang.Void> com.hermnet.api.controller.MessageController.sendMessage(com.hermnet.api.dto.SendMessageRequest): [Field error in object 'sendMessageRequest' on field 'recipientId': rejected value []; codes [NotBlank.sendMessageRequest.recipientId,NotBlank.recipientId,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendMessageRequest.recipientId,recipientId]; arguments []; default message [recipientId]]; default message [Recipient ID is required]] ]
2026-02-12 12:02:09 [main] WARN  o.s.w.s.m.s.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<java.lang.Void> com.hermnet.api.controller.MessageController.sendMessage(com.hermnet.api.dto.SendMessageRequest): [Field error in object 'sendMessageRequest' on field 'stegoImage': rejected value [{}]; codes [Size.sendMessageRequest.stegoImage,Size.stegoImage,Size.[B,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendMessageRequest.stegoImage,stegoImage]; arguments []; default message [stegoImage],2147483647,1]; default message [Stego image cannot be empty]] ]
2026-02-12 16:39:32 [main] INFO  c.h.a.controller.AuthControllerTest - Starting AuthControllerTest using Java 21.0.6 with PID 4864 (started by alvar in C:\Users\alvar\Desktop\Hermnet\backend)
2026-02-12 16:39:32 [main] INFO  c.h.a.controller.AuthControllerTest - No active profile set, falling back to 1 default profile: "default"
2026-02-12 16:39:35 [main] WARN  o.s.b.a.s.s.UserDetailsServiceAutoConfiguration - 

Using generated security password: 497fb336-ec33-4713-b0f8-ab700b2f1e91

This generated password is for development use only. Your security configuration must be updated before running your application in production.

2026-02-12 16:39:35 [main] INFO  c.h.a.controller.AuthControllerTest - Started AuthControllerTest in 4.377 seconds (process running for 9.124)
2026-02-12 16:39:36 [main] WARN  o.s.w.s.m.s.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.hermnet.api.dto.UserResponse> com.hermnet.api.controller.AuthController.register(com.hermnet.api.dto.RegisterRequest): [Field error in object 'registerRequest' on field 'publicKey': rejected value []; codes [NotBlank.registerRequest.publicKey,NotBlank.publicKey,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [registerRequest.publicKey,publicKey]; arguments []; default message [publicKey]]; default message [La clave pública es obligatoria]] ]
2026-02-12 16:39:36 [main] WARN  o.s.w.s.m.s.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.hermnet.api.dto.UserResponse> com.hermnet.api.controller.AuthController.register(com.hermnet.api.dto.RegisterRequest): [Field error in object 'registerRequest' on field 'id': rejected value [HNET-1234]; codes [Pattern.registerRequest.id,Pattern.id,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [registerRequest.id,id]; arguments []; default message [id],[Ljakarta.validation.constraints.Pattern$Flag;@54530644,^HNET-[A-Za-z0-9]{5,}$]; default message [El ID debe empezar por HNET- y tener caracteres alfanuméricos]] ]
2026-02-12 16:39:36 [main] WARN  o.s.w.s.m.s.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.hermnet.api.dto.UserResponse> com.hermnet.api.controller.AuthController.register(com.hermnet.api.dto.RegisterRequest): [Field error in object 'registerRequest' on field 'id': rejected value [INVALID-ID]; codes [Pattern.registerRequest.id,Pattern.id,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [registerRequest.id,id]; arguments []; default message [id],[Ljakarta.validation.constraints.Pattern$Flag;@54530644,^HNET-[A-Za-z0-9]{5,}$]; default message [El ID debe empezar por HNET- y tener caracteres alfanuméricos]] ]
2026-02-12 16:39:36 [main] INFO  c.h.a.c.MessageControllerTest - Starting MessageControllerTest using Java 21.0.6 with PID 4864 (started by alvar in C:\Users\alvar\Desktop\Hermnet\backend)
2026-02-12 16:39:36 [main] INFO  c.h.a.c.MessageControllerTest - No active profile set, falling back to 1 default profile: "default"
2026-02-12 16:39:37 [main] WARN  o.s.b.a.s.s.UserDetailsServiceAutoConfiguration - 

Using generated security password: 3bc4b89d-2451-4b92-af5e-d326deee71d2

This generated password is for development use only. Your security configuration must be updated before running your application in production.

2026-02-12 16:39:37 [main] INFO  c.h.a.c.MessageControllerTest - Started MessageControllerTest in 0.739 seconds (process running for 10.509)
2026-02-12 16:39:37 [main] WARN  o.s.w.s.m.s.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<java.lang.Void> com.hermnet.api.controller.MessageController.sendMessage(com.hermnet.api.dto.SendMessageRequest): [Field error in object 'sendMessageRequest' on field 'stegoImage': rejected value [null]; codes [NotNull.sendMessageRequest.stegoImage,NotNull.stegoImage,NotNull.[B,NotNull]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendMessageRequest.stegoImage,stegoImage]; arguments []; default message [stegoImage]]; default message [Stego image is required]] ]
2026-02-12 16:39:37 [main] WARN  o.s.w.s.m.s.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<java.lang.Void> com.hermnet.api.controller.MessageController.sendMessage(com.hermnet.api.dto.SendMessageRequest): [Field error in object 'sendMessageRequest' on field 'recipientId': rejected value []; codes [NotBlank.sendMessageRequest.recipientId,NotBlank.recipientId,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendMessageRequest.recipientId,recipientId]; arguments []; default message [recipientId]]; default message [Recipient ID is required]] ]
2026-02-12 16:39:37 [main] WARN  o.s.w.s.m.s.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<java.lang.Void> com.hermnet.api.controller.MessageController.sendMessage(com.hermnet.api.dto.SendMessageRequest): [Field error in object 'sendMessageRequest' on field 'stegoImage': rejected value [{}]; codes [Size.sendMessageRequest.stegoImage,Size.stegoImage,Size.[B,Size]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [sendMessageRequest.stegoImage,stegoImage]; arguments []; default message [stegoImage],2147483647,1]; default message [Stego image cannot be empty]] ]
2026-02-12 16:39:37 [main] INFO  c.h.api.HermnetApiApplicationTests - Starting HermnetApiApplicationTests using Java 21.0.6 with PID 4864 (started by alvar in C:\Users\alvar\Desktop\Hermnet\backend)
2026-02-12 16:39:37 [main] INFO  c.h.api.HermnetApiApplicationTests - No active profile set, falling back to 1 default profile: "default"
2026-02-12 16:39:38 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2026-02-12 16:39:39 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@56ece9c
2026-02-12 16:39:39 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2026-02-12 16:39:40 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2026-02-12 16:39:41 [main] DEBUG org.hibernate.SQL - set client_min_messages = WARNING
2026-02-12 16:39:41 [main] DEBUG org.hibernate.SQL - alter table if exists auth_challenges drop constraint if exists FKl5m80koyne9ork274crpw6jv
2026-02-12 16:39:41 [main] DEBUG org.hibernate.SQL - drop table if exists auth_challenges cascade
2026-02-12 16:39:41 [main] DEBUG org.hibernate.SQL - drop table if exists mailbox cascade
2026-02-12 16:39:41 [main] DEBUG org.hibernate.SQL - drop table if exists rate_limit_buckets cascade
2026-02-12 16:39:41 [main] DEBUG org.hibernate.SQL - drop table if exists token_blacklist cascade
2026-02-12 16:39:41 [main] DEBUG org.hibernate.SQL - drop table if exists users cascade
2026-02-12 16:39:41 [main] DEBUG org.hibernate.SQL - create table auth_challenges (challenge_id bigint generated by default as identity, expires_at timestamp(6) not null, nonce varchar(64) not null, user_hash varchar(64) not null, primary key (challenge_id))
2026-02-12 16:39:41 [main] DEBUG org.hibernate.SQL - create table mailbox (created_at timestamp(6) not null, message_id bigint generated by default as identity, recipient_hash varchar(64) not null, stego_packet oid not null, primary key (message_id))
2026-02-12 16:39:41 [main] DEBUG org.hibernate.SQL - create table rate_limit_buckets (request_count integer not null, reset_time timestamp(6) not null, ip_hash varchar(64) not null, primary key (ip_hash))
2026-02-12 16:39:41 [main] DEBUG org.hibernate.SQL - create table token_blacklist (expires_at timestamp(6) not null, revoked_reason varchar(20), jti varchar(36) not null, primary key (jti))
2026-02-12 16:39:41 [main] DEBUG org.hibernate.SQL - create table users (created_at timestamp(6) not null, id_hash varchar(64) not null, public_key TEXT not null unique, push_token TEXT, primary key (id_hash))
2026-02-12 16:39:41 [main] DEBUG org.hibernate.SQL - create index idx_mailbox_recipient on mailbox (recipient_hash)
2026-02-12 16:39:41 [main] DEBUG org.hibernate.SQL - alter table if exists auth_challenges add constraint FKl5m80koyne9ork274crpw6jv foreign key (user_hash) references users
2026-02-12 16:39:41 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2026-02-12 16:39:41 [main] WARN  o.s.b.a.s.s.UserDetailsServiceAutoConfiguration - 

Using generated security password: 9cd546a6-4526-4c1d-aeaf-062a0f0a021a

This generated password is for development use only. Your security configuration must be updated before running your application in production.

2026-02-12 16:39:42 [main] INFO  c.h.api.HermnetApiApplicationTests - Started HermnetApiApplicationTests in 5.015 seconds (process running for 15.677)
2026-02-12 16:39:42 [main] INFO  c.h.a.r.AuthChallengeRepositoryTest - Starting AuthChallengeRepositoryTest using Java 21.0.6 with PID 4864 (started by alvar in C:\Users\alvar\Desktop\Hermnet\backend)
2026-02-12 16:39:42 [main] INFO  c.h.a.r.AuthChallengeRepositoryTest - No active profile set, falling back to 1 default profile: "default"
2026-02-12 16:39:42 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-2 - Starting...
2026-02-12 16:39:42 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-2 - Added connection org.postgresql.jdbc.PgConnection@49bc9588
2026-02-12 16:39:42 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-2 - Start completed.
2026-02-12 16:39:42 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2026-02-12 16:39:43 [main] DEBUG org.hibernate.SQL - set client_min_messages = WARNING
2026-02-12 16:39:43 [main] DEBUG org.hibernate.SQL - alter table if exists auth_challenges drop constraint if exists FKl5m80koyne9ork274crpw6jv
2026-02-12 16:39:43 [main] DEBUG org.hibernate.SQL - drop table if exists auth_challenges cascade
2026-02-12 16:39:43 [main] DEBUG org.hibernate.SQL - drop table if exists mailbox cascade
2026-02-12 16:39:43 [main] DEBUG org.hibernate.SQL - drop table if exists rate_limit_buckets cascade
2026-02-12 16:39:43 [main] DEBUG org.hibernate.SQL - drop table if exists token_blacklist cascade
2026-02-12 16:39:43 [main] DEBUG org.hibernate.SQL - drop table if exists users cascade
2026-02-12 16:39:43 [main] DEBUG org.hibernate.SQL - create table auth_challenges (challenge_id bigint generated by default as identity, expires_at timestamp(6) not null, nonce varchar(64) not null, user_hash varchar(64) not null, primary key (challenge_id))
2026-02-12 16:39:43 [main] DEBUG org.hibernate.SQL - create table mailbox (created_at timestamp(6) not null, message_id bigint generated by default as identity, recipient_hash varchar(64) not null, stego_packet oid not null, primary key (message_id))
2026-02-12 16:39:43 [main] DEBUG org.hibernate.SQL - create table rate_limit_buckets (request_count integer not null, reset_time timestamp(6) not null, ip_hash varchar(64) not null, primary key (ip_hash))
2026-02-12 16:39:43 [main] DEBUG org.hibernate.SQL - create table token_blacklist (expires_at timestamp(6) not null, revoked_reason varchar(20), jti varchar(36) not null, primary key (jti))
2026-02-12 16:39:43 [main] DEBUG org.hibernate.SQL - create table users (created_at timestamp(6) not null, id_hash varchar(64) not null, public_key TEXT not null unique, push_token TEXT, primary key (id_hash))
2026-02-12 16:39:43 [main] DEBUG org.hibernate.SQL - create index idx_mailbox_recipient on mailbox (recipient_hash)
2026-02-12 16:39:43 [main] DEBUG org.hibernate.SQL - alter table if exists auth_challenges add constraint FKl5m80koyne9ork274crpw6jv foreign key (user_hash) references users
2026-02-12 16:39:43 [main] INFO  c.h.a.r.AuthChallengeRepositoryTest - Started AuthChallengeRepositoryTest in 0.727 seconds (process running for 16.558)
2026-02-12 16:39:43 [main] DEBUG org.hibernate.SQL - select ac1_0.challenge_id,ac1_0.expires_at,ac1_0.nonce,ac1_0.user_hash from auth_challenges ac1_0
2026-02-12 16:39:43 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 16:39:43 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 16:39:43 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 16:39:43 [main] DEBUG org.hibernate.SQL - select null,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 16:39:43 [main] DEBUG org.hibernate.SQL - insert into auth_challenges (expires_at,nonce,user_hash) values (?,?,?)
2026-02-12 16:39:43 [main] DEBUG org.hibernate.SQL - insert into auth_challenges (expires_at,nonce,user_hash) values (?,?,?)
2026-02-12 16:39:43 [main] DEBUG org.hibernate.SQL - select ac1_0.challenge_id,ac1_0.expires_at,ac1_0.nonce,ac1_0.user_hash from auth_challenges ac1_0 where ac1_0.expires_at<?
2026-02-12 16:39:43 [main] DEBUG org.hibernate.SQL - delete from auth_challenges where challenge_id=?
2026-02-12 16:39:43 [main] DEBUG org.hibernate.SQL - select ac1_0.challenge_id,ac1_0.expires_at,ac1_0.nonce,ac1_0.user_hash from auth_challenges ac1_0
2026-02-12 16:39:43 [main] DEBUG org.hibernate.SQL - select ac1_0.challenge_id,ac1_0.expires_at,ac1_0.nonce,ac1_0.user_hash from auth_challenges ac1_0
2026-02-12 16:39:43 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 16:39:43 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 16:39:43 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 16:39:43 [main] DEBUG org.hibernate.SQL - select null,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 16:39:43 [main] DEBUG org.hibernate.SQL - insert into auth_challenges (expires_at,nonce,user_hash) values (?,?,?)
2026-02-12 16:39:43 [main] DEBUG org.hibernate.SQL - select ac1_0.challenge_id,ac1_0.expires_at,ac1_0.nonce,ac1_0.user_hash from auth_challenges ac1_0 where ac1_0.nonce=?
2026-02-12 16:39:43 [main] DEBUG org.hibernate.SQL - select ac1_0.challenge_id,ac1_0.expires_at,ac1_0.nonce,ac1_0.user_hash from auth_challenges ac1_0
2026-02-12 16:39:43 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 16:39:43 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 16:39:43 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 16:39:43 [main] DEBUG org.hibernate.SQL - select null,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 16:39:43 [main] DEBUG org.hibernate.SQL - insert into auth_challenges (expires_at,nonce,user_hash) values (?,?,?)
2026-02-12 16:39:43 [main] DEBUG org.hibernate.SQL - insert into auth_challenges (expires_at,nonce,user_hash) values (?,?,?)
2026-02-12 16:39:43 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 16:39:43 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 16:39:43 [main] DEBUG org.hibernate.SQL - select null,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 16:39:43 [main] DEBUG org.hibernate.SQL - insert into auth_challenges (expires_at,nonce,user_hash) values (?,?,?)
2026-02-12 16:39:44 [main] DEBUG org.hibernate.SQL - select count(*) from auth_challenges ac1_0
2026-02-12 16:39:44 [main] DEBUG org.hibernate.SQL - select ac1_0.challenge_id,ac1_0.expires_at,ac1_0.nonce,ac1_0.user_hash from auth_challenges ac1_0 where ac1_0.user_hash=?
2026-02-12 16:39:44 [main] DEBUG org.hibernate.SQL - delete from auth_challenges where challenge_id=?
2026-02-12 16:39:44 [main] DEBUG org.hibernate.SQL - delete from auth_challenges where challenge_id=?
2026-02-12 16:39:44 [main] DEBUG org.hibernate.SQL - select count(*) from auth_challenges ac1_0
2026-02-12 16:39:44 [main] DEBUG org.hibernate.SQL - select ac1_0.challenge_id,ac1_0.expires_at,ac1_0.nonce,ac1_0.user_hash from auth_challenges ac1_0 where ac1_0.nonce=?
2026-02-12 16:39:44 [main] DEBUG org.hibernate.SQL - select ac1_0.challenge_id,ac1_0.expires_at,ac1_0.nonce,ac1_0.user_hash from auth_challenges ac1_0
2026-02-12 16:39:44 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 16:39:44 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 16:39:44 [main] DEBUG org.hibernate.SQL - select ac1_0.challenge_id,ac1_0.expires_at,ac1_0.nonce,ac1_0.user_hash from auth_challenges ac1_0 where ac1_0.user_hash=?
2026-02-12 16:39:44 [main] DEBUG org.hibernate.SQL - select bt1_0.jti,bt1_0.expires_at,bt1_0.revoked_reason from token_blacklist bt1_0
2026-02-12 16:39:44 [main] DEBUG org.hibernate.SQL - select bt1_0.jti,bt1_0.expires_at,bt1_0.revoked_reason from token_blacklist bt1_0 where bt1_0.jti=?
2026-02-12 16:39:44 [main] DEBUG org.hibernate.SQL - select bt1_0.jti,bt1_0.expires_at,bt1_0.revoked_reason from token_blacklist bt1_0
2026-02-12 16:39:44 [main] DEBUG org.hibernate.SQL - select bt1_0.jti,bt1_0.expires_at,bt1_0.revoked_reason from token_blacklist bt1_0 where bt1_0.jti=?
2026-02-12 16:39:44 [main] DEBUG org.hibernate.SQL - insert into token_blacklist (expires_at,revoked_reason,jti) values (?,?,?)
2026-02-12 16:39:44 [main] DEBUG org.hibernate.SQL - select count(*) from token_blacklist bt1_0 where bt1_0.jti=?
2026-02-12 16:39:44 [main] DEBUG org.hibernate.SQL - select count(*) from token_blacklist bt1_0 where bt1_0.jti=?
2026-02-12 16:39:44 [main] DEBUG org.hibernate.SQL - select bt1_0.jti,bt1_0.expires_at,bt1_0.revoked_reason from token_blacklist bt1_0
2026-02-12 16:39:44 [main] DEBUG org.hibernate.SQL - select bt1_0.jti,bt1_0.expires_at,bt1_0.revoked_reason from token_blacklist bt1_0 where bt1_0.jti=?
2026-02-12 16:39:44 [main] DEBUG org.hibernate.SQL - insert into token_blacklist (expires_at,revoked_reason,jti) values (?,?,?)
2026-02-12 16:39:44 [main] DEBUG org.hibernate.SQL - select count(*) from token_blacklist bt1_0 where bt1_0.jti=?
2026-02-12 16:39:44 [main] DEBUG org.hibernate.SQL - delete from token_blacklist where jti=?
2026-02-12 16:39:44 [main] DEBUG org.hibernate.SQL - select count(*) from token_blacklist bt1_0 where bt1_0.jti=?
2026-02-12 16:39:44 [main] DEBUG org.hibernate.SQL - select m1_0.message_id,m1_0.created_at,m1_0.recipient_hash,m1_0.stego_packet from mailbox m1_0
2026-02-12 16:39:44 [main] DEBUG org.hibernate.SQL - insert into mailbox (created_at,recipient_hash,stego_packet) values (?,?,?)
2026-02-12 16:39:44 [main] DEBUG org.hibernate.SQL - select m1_0.message_id,m1_0.created_at,m1_0.recipient_hash,m1_0.stego_packet from mailbox m1_0
2026-02-12 16:39:44 [main] DEBUG org.hibernate.SQL - select m1_0.message_id,m1_0.created_at,m1_0.recipient_hash,m1_0.stego_packet from mailbox m1_0
2026-02-12 16:39:44 [main] DEBUG org.hibernate.SQL - insert into mailbox (created_at,recipient_hash,stego_packet) values (?,?,?)
2026-02-12 16:39:44 [main] DEBUG org.hibernate.SQL - select m1_0.message_id,m1_0.created_at,m1_0.recipient_hash,m1_0.stego_packet from mailbox m1_0 where m1_0.created_at<?
2026-02-12 16:39:44 [main] DEBUG org.hibernate.SQL - delete from mailbox where message_id=?
2026-02-12 16:39:44 [main] DEBUG org.hibernate.SQL - select m1_0.message_id,m1_0.created_at,m1_0.recipient_hash,m1_0.stego_packet from mailbox m1_0
2026-02-12 16:39:44 [main] DEBUG org.hibernate.SQL - select m1_0.message_id,m1_0.created_at,m1_0.recipient_hash,m1_0.stego_packet from mailbox m1_0
2026-02-12 16:39:44 [main] DEBUG org.hibernate.SQL - insert into mailbox (created_at,recipient_hash,stego_packet) values (?,?,?)
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - insert into mailbox (created_at,recipient_hash,stego_packet) values (?,?,?)
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - insert into mailbox (created_at,recipient_hash,stego_packet) values (?,?,?)
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select m1_0.message_id,m1_0.created_at,m1_0.recipient_hash,m1_0.stego_packet from mailbox m1_0 where m1_0.recipient_hash=? order by m1_0.created_at desc
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select rlb1_0.ip_hash,rlb1_0.request_count,rlb1_0.reset_time from rate_limit_buckets rlb1_0
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select rlb1_0.ip_hash,rlb1_0.request_count,rlb1_0.reset_time from rate_limit_buckets rlb1_0 where rlb1_0.ip_hash=?
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select rlb1_0.ip_hash,rlb1_0.request_count,rlb1_0.reset_time from rate_limit_buckets rlb1_0
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select rlb1_0.ip_hash,rlb1_0.request_count,rlb1_0.reset_time from rate_limit_buckets rlb1_0 where rlb1_0.ip_hash=?
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select rlb1_0.ip_hash,rlb1_0.request_count,rlb1_0.reset_time from rate_limit_buckets rlb1_0
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select rlb1_0.ip_hash,rlb1_0.request_count,rlb1_0.reset_time from rate_limit_buckets rlb1_0 where rlb1_0.ip_hash=?
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.public_key=?
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select count(*) from users u1_0
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.public_key=?
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select count(*) from users u1_0 where u1_0.id_hash=?
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select count(*) from users u1_0 where u1_0.id_hash=?
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - delete from users where id_hash=?
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select count(*) from users u1_0 where u1_0.id_hash=?
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select count(*) from users u1_0
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 16:39:45 [main] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 23505
2026-02-12 16:39:45 [main] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: duplicate key value violates unique constraint "users_public_key_key"
  Detail: Key (public_key)=(duplicate-key) already exists.
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - delete from users where id_hash=?
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select count(*) from users u1_0 where u1_0.id_hash=?
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - delete from users where id_hash=?
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - delete from users where id_hash=?
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select count(*) from users u1_0
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select count(*) from users u1_0
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select count(*) from users u1_0
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select u1_0.id_hash,u1_0.created_at,u1_0.public_key,u1_0.push_token from users u1_0 where u1_0.id_hash=?
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - insert into users (created_at,public_key,push_token,id_hash) values (?,?,?,?)
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - update users set public_key=?,push_token=? where id_hash=?
2026-02-12 16:39:45 [main] DEBUG org.hibernate.SQL - select count(*) from users u1_0
2026-02-12 16:39:45 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2026-02-12 16:39:45 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2026-02-12 16:39:45 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-2 - Shutdown initiated...
2026-02-12 16:39:45 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-2 - Shutdown completed.
<<<<<<< HEAD
2026-02-12 17:06:51 [main] INFO  c.h.a.controller.AuthControllerTest - Starting AuthControllerTest using Java 21.0.6 with PID 20960 (started by alvar in C:\Users\alvar\Desktop\Hermnet\backend)
2026-02-12 17:06:51 [main] INFO  c.h.a.controller.AuthControllerTest - No active profile set, falling back to 1 default profile: "default"
2026-02-12 17:06:54 [main] WARN  o.s.b.a.s.s.UserDetailsServiceAutoConfiguration - 

Using generated security password: e7453a37-777f-40c5-b5ae-d4d9017196e6

This generated password is for development use only. Your security configuration must be updated before running your application in production.

2026-02-12 17:06:55 [main] INFO  c.h.a.controller.AuthControllerTest - Started AuthControllerTest in 3.65 seconds (process running for 4.86)
2026-02-12 17:06:55 [main] WARN  o.s.w.s.m.s.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.hermnet.api.dto.UserResponse> com.hermnet.api.controller.AuthController.register(com.hermnet.api.dto.RegisterRequest): [Field error in object 'registerRequest' on field 'publicKey': rejected value []; codes [NotBlank.registerRequest.publicKey,NotBlank.publicKey,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [registerRequest.publicKey,publicKey]; arguments []; default message [publicKey]]; default message [La clave pública es obligatoria]] ]
2026-02-12 17:06:55 [main] WARN  o.s.w.s.m.s.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.hermnet.api.dto.UserResponse> com.hermnet.api.controller.AuthController.register(com.hermnet.api.dto.RegisterRequest): [Field error in object 'registerRequest' on field 'id': rejected value [HNET-1234]; codes [Pattern.registerRequest.id,Pattern.id,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [registerRequest.id,id]; arguments []; default message [id],[Ljakarta.validation.constraints.Pattern$Flag;@4a47bc9c,^HNET-[A-Za-z0-9]{5,}$]; default message [El ID debe empezar por HNET- y tener caracteres alfanuméricos]] ]
2026-02-12 17:06:55 [main] WARN  o.s.w.s.m.s.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.hermnet.api.dto.UserResponse> com.hermnet.api.controller.AuthController.register(com.hermnet.api.dto.RegisterRequest): [Field error in object 'registerRequest' on field 'id': rejected value [INVALID-ID]; codes [Pattern.registerRequest.id,Pattern.id,Pattern.java.lang.String,Pattern]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [registerRequest.id,id]; arguments []; default message [id],[Ljakarta.validation.constraints.Pattern$Flag;@4a47bc9c,^HNET-[A-Za-z0-9]{5,}$]; default message [El ID debe empezar por HNET- y tener caracteres alfanuméricos]] ]
=======
>>>>>>> dc477c751fa40f93564f84812c5e9f8664a5937f
2026-02-12 19:20:57 [main] INFO  c.h.a.c.MessageControllerSecurityTest - Starting MessageControllerSecurityTest using Java 21.0.6 with PID 19276 (started by alvar in C:\Users\alvar\Desktop\Hermnet\backend)
2026-02-12 19:20:57 [main] INFO  c.h.a.c.MessageControllerSecurityTest - No active profile set, falling back to 1 default profile: "default"
2026-02-12 19:21:00 [main] WARN  o.s.b.a.s.s.UserDetailsServiceAutoConfiguration - 

Using generated security password: 7485511a-308d-4078-8786-241b74a6b816

This generated password is for development use only. Your security configuration must be updated before running your application in production.

2026-02-12 19:21:01 [main] INFO  c.h.a.c.MessageControllerSecurityTest - Started MessageControllerSecurityTest in 4.126 seconds (process running for 5.336)
2026-02-12 19:25:18 [main] INFO  c.h.a.s.SecurityIntegrationTest - Starting SecurityIntegrationTest using Java 21.0.6 with PID 13664 (started by alvar in C:\Users\alvar\Desktop\Hermnet\backend)
2026-02-12 19:25:18 [main] INFO  c.h.a.s.SecurityIntegrationTest - No active profile set, falling back to 1 default profile: "default"
2026-02-12 19:25:21 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2026-02-12 19:25:22 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@362be0cd
2026-02-12 19:25:22 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2026-02-12 19:25:22 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2026-02-12 19:25:23 [main] DEBUG org.hibernate.SQL - set client_min_messages = WARNING
2026-02-12 19:25:23 [main] DEBUG org.hibernate.SQL - alter table if exists auth_challenges drop constraint if exists FKl5m80koyne9ork274crpw6jv
2026-02-12 19:25:23 [main] DEBUG org.hibernate.SQL - drop table if exists auth_challenges cascade
2026-02-12 19:25:23 [main] DEBUG org.hibernate.SQL - drop table if exists mailbox cascade
2026-02-12 19:25:23 [main] DEBUG org.hibernate.SQL - drop table if exists rate_limit_buckets cascade
2026-02-12 19:25:23 [main] DEBUG org.hibernate.SQL - drop table if exists token_blacklist cascade
2026-02-12 19:25:23 [main] DEBUG org.hibernate.SQL - drop table if exists users cascade
2026-02-12 19:25:23 [main] DEBUG org.hibernate.SQL - create table auth_challenges (challenge_id bigint generated by default as identity, expires_at timestamp(6) not null, nonce varchar(64) not null, user_hash varchar(64) not null, primary key (challenge_id))
2026-02-12 19:25:23 [main] DEBUG org.hibernate.SQL - create table mailbox (created_at timestamp(6) not null, message_id bigint generated by default as identity, recipient_hash varchar(64) not null, stego_packet oid not null, primary key (message_id))
2026-02-12 19:25:24 [main] DEBUG org.hibernate.SQL - create table rate_limit_buckets (request_count integer not null, reset_time timestamp(6) not null, ip_hash varchar(64) not null, primary key (ip_hash))
2026-02-12 19:25:24 [main] DEBUG org.hibernate.SQL - create table token_blacklist (expires_at timestamp(6) not null, revoked_reason varchar(20), jti varchar(36) not null, primary key (jti))
2026-02-12 19:25:24 [main] DEBUG org.hibernate.SQL - create table users (created_at timestamp(6) not null, id_hash varchar(64) not null, public_key TEXT not null unique, push_token TEXT, primary key (id_hash))
2026-02-12 19:25:24 [main] DEBUG org.hibernate.SQL - create index idx_mailbox_recipient on mailbox (recipient_hash)
2026-02-12 19:25:24 [main] DEBUG org.hibernate.SQL - alter table if exists auth_challenges add constraint FKl5m80koyne9ork274crpw6jv foreign key (user_hash) references users
2026-02-12 19:25:24 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2026-02-12 19:25:24 [main] WARN  o.s.b.a.s.s.UserDetailsServiceAutoConfiguration - 

Using generated security password: 3b72ac09-d00f-4455-82ff-6d5daf27e394

This generated password is for development use only. Your security configuration must be updated before running your application in production.

2026-02-12 19:25:25 [main] INFO  c.h.a.s.SecurityIntegrationTest - Started SecurityIntegrationTest in 7.228 seconds (process running for 8.44)
2026-02-12 19:25:25 [main] WARN  o.s.w.s.m.s.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.hermnet.api.dto.UserResponse> com.hermnet.api.controller.AuthController.register(com.hermnet.api.dto.RegisterRequest) with 2 errors: [Field error in object 'registerRequest' on field 'publicKey': rejected value [null]; codes [NotBlank.registerRequest.publicKey,NotBlank.publicKey,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [registerRequest.publicKey,publicKey]; arguments []; default message [publicKey]]; default message [La clave pública es obligatoria]] [Field error in object 'registerRequest' on field 'id': rejected value [null]; codes [NotBlank.registerRequest.id,NotBlank.id,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [registerRequest.id,id]; arguments []; default message [id]]; default message [El ID es obligatorio]] ]
2026-02-12 19:25:26 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2026-02-12 19:25:26 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
